import{A as re}from"./AuthenticatedLayout-Di-2FOMO.js";import{l as U,m as B,bz as ne,b as o,d as a,f as e,b1 as Q,e as d,w as h,g as S,aF as O,n as W,bP as le,Q as de,o as ie,a as g,bI as Z,bx as H,F as w,i as T,t as s,u as X,k as m,Z as ce}from"./vue.m-BoM48gZa.js";import{_ as ue}from"./Pagination-lRXMoJjk.js";import{_ as A,a as _e}from"./CancelButton-CYN4UORr.js";import{_ as J}from"./TextInput-lN6ApOBV.js";import{R as me}from"./ResponsiveTable-D6b5B55q.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseButton-CVzmqfRt.js";const pe={class:"p-6 border-b border-main-200"},he={class:"p-6 max-h-96 overflow-y-auto"},xe={class:"p-6 border-t border-main-200 te"},be={__name:"FullPageModal",props:{modelValue:{type:Boolean,default:!1},size:{type:String,default:"md"}},emits:["update:modelValue"],setup(u,{emit:k}){const v=u,y=k,x=()=>{y("update:modelValue",!1)},V=U(()=>{const p={lg:"max-w-4xl w-full",md:"max-w-lg w-full",sm:"max-w-md w-full"};return p[v.size]||p.md});return(p,$)=>B((o(),a("div",{class:"fixed inset-0 bg-main-800 bg-opacity-75 flex justify-center items-center",onClick:x},[e("div",{class:O([V.value,"bg-white rounded-lg shadow-lg flex flex-col"]),onClick:$[0]||($[0]=W(()=>{},["stop"]))},[e("div",pe,[Q(p.$slots,"header")]),e("div",he,[Q(p.$slots,"default")]),e("div",xe,[d(A,{size:"sm",onClick:x},{default:h(()=>[S("閉じる")]),_:1})])],2)],512)),[[ne,u.modelValue]])}},ve=e("i",{class:"fa fa-clone text-main-400 hover:text-main-600"},null,-1),ye=[ve],fe={__name:"CopyToClipboard",props:{text:{type:String}},setup(u){const k=u;function v(){const y=k.text||"";navigator.clipboard.writeText(y).then(()=>{le.success("クリップボードにコピーしました")}).catch(x=>{console.error("クリップボードへのコピーに失敗しました:",x)})}return(y,x)=>(o(),a("button",{onClick:v,class:"inline-flex items-center",title:"クリップボードにコピー"},ye))}},ge={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},we=e("label",{for:"order-id",class:"block text-sm font-medium text-gray-700"},"注文ID",-1),ke=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},"ステータス",-1),$e=e("option",{value:""},"選択してください",-1),Ce=["value"],Se=e("label",{for:"order-type",class:"block text-sm font-medium text-gray-700"},"注文タイプ",-1),Ve=e("option",{value:""},"選択してください",-1),Pe=["value"],Te=e("label",{for:"product-name",class:"block text-sm font-medium text-gray-700"},"商品名",-1),qe={class:"text-right mt-4 mb-6"},ze={class:"w-full text-xs"},Ie={class:"bg-main-600 text-white text-xs"},Me=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"注文タイプ",-1),Ue=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"商品名",-1),Be=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"注文ID",-1),Oe=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"ステータス",-1),Ae={key:0,class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},Le=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"注文日時",-1),Ne=e("th",{class:"border border-gray-300 px-3 py-1 text-nowrap font-bold"},"詳細",-1),De={class:"border border-gray-300 px-3 py-1 text-nowrap"},Fe={class:"border border-gray-300 px-3 py-1 text-nowrap"},Ke={class:"border border-gray-300 px-3 py-1 text-nowrap"},Re={class:"border border-gray-300 px-3 py-1 text-nowrap text-center"},Ee=["onClick"],je={key:0,class:"border border-gray-300 px-3 py-1 text-right text-nowrap"},Ge={class:"border border-gray-300 px-3 py-1 text-nowrap text-center"},Qe={class:"border border-gray-300 px-3 py-1 text-center text-nowrap"},Ze={key:0},He=e("td",{class:"border border-gray-300 p-4 text-center",colspan:"11"},"データがありません",-1),Je=[He],We={class:"flex items-center"},Xe=e("h2",{class:"text-2xl font-bold"},"注文詳細",-1),Ye={class:"text-sm ml-3 flex items-center"},et={class:"font-medium text-main-700 px-2 py-1"},tt={class:"flex items-center mt-2"},st={class:"px-4 py-1 bg-indigo-100 text-xs text-main-600 rounded-full text-sm font-medium"},ot={class:"ml-2 text-main-600 text-xs"},at={class:"space-y-5"},rt={class:"grid grid-cols-1 md:grid-cols-2 gap-7 text-sm"},nt={class:"bg-main-100 rounded-t overflow-hidden"},lt=e("div",{class:"bg-main-600 px-4 py-2"},[e("h3",{class:"text-white font-medium text-sm"},"基本情報")],-1),dt={class:"p-4 space-y-3"},it={class:"flex items-start"},ct=e("span",{class:"text-main-500 w-24 flex-shrink-0 font-semibold"},"注文日時:",-1),ut={class:"text-main-700"},_t={class:"bg-main-100 rounded-t overflow-hidden"},mt=e("div",{class:"bg-main-600 px-4 py-2"},[e("h3",{class:"text-white font-medium text-sm"},"売上情報")],-1),pt={class:"p-4 space-y-3"},ht={key:0,class:"flex items-start mb-2"},xt=e("span",{class:"text-main-500 w-24 flex-shrink-0 font-semibold"},"商品名:",-1),bt={class:"text-main-700"},vt={key:1,class:"flex items-start"},yt=e("span",{class:"text-main-500 w-24 flex-shrink-0 font-semibold"},"商品名:",-1),ft={class:"font-medium"},gt={key:2,class:"mt-2 pt-2 border-t border-main-200"},wt={class:"flex items-start"},kt=e("span",{class:"text-main-500 w-24 flex-shrink-0 font-semibold"},"合計金額:",-1),$t={class:"text-main-700 text-lg leading-none"},Ct={class:"text-xs text-main-600 mt-3 px-2 py-1 bg-main-200"},St={class:"inline-block"},Vt={class:"text-main-700inline-block ml-3"},Pt={key:0,class:"bg-main-100 rounded-t overflow-hidden"},Tt={class:"bg-main-600 px-4 py-2"},qt={class:"text-white font-medium text-sm"},zt={class:"p-0"},It={class:"w-full text-xs"},Mt={class:"w-48 py-2 px-4 pr-4 text-nowrap pr-10"},Ut={class:"py-2 px-2 pr-4"},Bt={key:0},Ot={key:1},At={key:2},Lt={key:0},Nt={key:1,class:"text-main-500"},Dt={__name:"OrderList",props:{guard:{type:String,required:!0},orderTypes:{type:Array,required:!0}},setup(u){const v=u.guard,y=de(),x=y.props.multiAuthGuard,V=y.props.orderStatuses;ie(()=>{Y(),C()});const p=g([]),$=g([]);let q=1;const C=()=>{const l=route(`${v}.order.list`),n={params:{page:q,...c.value}};axios.get(l,n).then(t=>{p.value=t.data.data,$.value=t.data.meta.links})},c=g({customer_name:"",order_unique_id:"",status:"",order_type:"",product_name:""}),L=g(),Y=()=>{const l=new URLSearchParams(window.location.search);c.value.order_unique_id=l.get("order_unique_id")},z=()=>{q=1,C()},ee=l=>{q=l,C()},te=()=>{c.value={customer_name:"",order_unique_id:"",status:"",order_type:"",product_name:""},L.value.focus(),C()},N=U(()=>["admin","shop"].includes(x));U(()=>["admin","artisan"].includes(x));const I=g(!1),se=l=>{Swal.fire({title:"ステータス変更",input:"select",inputOptions:_.fromPairs(V.map(n=>[n.value,n.label])),inputPlaceholder:"ステータスを選択してください",showCancelButton:!0,confirmButtonText:"変更",cancelButtonText:"キャンセル",showLoaderOnConfirm:!0,reverseButtons:!0,preConfirm:n=>{const t=route(`${v}.order.update_status`,{order:l.id}),f={status:n};return axios.put(t,f).then(b=>{b.data.result===!0&&(C(),Swal.close(),Swal.fire({icon:"success",title:"ステータスを変更しました"}))}).catch(b=>{const P=b.response.data.errors.status[0];Swal.showValidationMessage(`エラー: ${P}`)})}})},r=g({}),oe=l=>{r.value=l,I.value=!0},D=l=>l.order_type==="product",ae=l=>l.order_type==="item";return(l,n)=>(o(),a(w,null,[e("div",ge,[e("div",null,[we,d(J,{ref_key:"searchInputOrderId",ref:L,"model-value":"searchParams.customer_name",class:"block w-full",modelValue:c.value.order_unique_id,"onUpdate:modelValue":n[0]||(n[0]=t=>c.value.order_unique_id=t),onKeydown:Z(z,["enter"])},null,8,["modelValue"])]),e("div",null,[ke,B(e("select",{id:"status",name:"status",class:"block w-full px-3 py-2 bg-white border border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-xs","onUpdate:modelValue":n[1]||(n[1]=t=>c.value.status=t)},[$e,(o(!0),a(w,null,T(X(V),t=>(o(),a("option",{key:t.value,value:t.value},s(t.label),9,Ce))),128))],512),[[H,c.value.status]])]),e("div",null,[Se,B(e("select",{id:"order-type",name:"order_type",class:"block w-full px-3 py-2 bg-white border border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-xs","onUpdate:modelValue":n[2]||(n[2]=t=>c.value.order_type=t)},[Ve,(o(!0),a(w,null,T(u.orderTypes,t=>(o(),a("option",{key:t.value,value:t.value},s(t.label),9,Pe))),128))],512),[[H,c.value.order_type]])]),e("div",null,[Te,d(J,{"model-value":"searchParams.customer_name",class:"block w-full",modelValue:c.value.product_name,"onUpdate:modelValue":n[3]||(n[3]=t=>c.value.product_name=t),onKeydown:Z(z,["enter"])},null,8,["modelValue"])])]),e("div",qe,[d(A,{size:"xs",class:"mr-1.5",onClick:z},{default:h(()=>[S("注文検索")]),_:1}),d(_e,{size:"xs",onClick:te},{default:h(()=>[S("リセット")]),_:1})]),d(me,{class:"mb-4"},{default:h(()=>[e("table",ze,[e("thead",Ie,[e("tr",null,[Me,Ue,Be,Oe,N.value?(o(),a("th",Ae,"合計金額")):m("",!0),Le,Ne])]),e("tbody",null,[(o(!0),a(w,null,T(p.value,t=>{var f;return o(),a("tr",{key:t.id,class:O(["odd:bg-gray-50 hover:bg-main-100",{"bg-gray-100":t.status==="completed"}])},[e("td",De,s(t.order_type_label),1),e("td",Fe,s(t.product_name),1),e("td",Ke,s(t.order_unique_id),1),e("td",Re,[e("a",{href:"#",class:"text-main-500 hover:underline",onClick:W(b=>se(t),["prevent"])},s(t.status_label),9,Ee)]),N.value?(o(),a("td",je,s((f=t.component)==null?void 0:f.total_amount_including_tax_text)+"円 ",1)):m("",!0),e("td",Ge,s(t.created_date),1),e("td",Qe,[d(A,{size:"xs",onClick:b=>oe(t)},{default:h(()=>[S("詳細")]),_:2},1032,["onClick"])])],2)}),128)),p.value.length===0?(o(),a("tr",Ze,Je)):m("",!0)])])]),_:1}),d(ue,{links:$.value,onMovePage:ee},null,8,["links"]),d(be,{size:"lg",modelValue:I.value,"onUpdate:modelValue":n[4]||(n[4]=t=>I.value=t)},{header:h(()=>[e("div",null,[e("div",We,[Xe,e("div",Ye,[e("span",et,s(r.value.order_unique_id),1),d(fe,{text:r.value.order_unique_id},null,8,["text"])])]),e("div",tt,[e("span",st,s(r.value.status_label),1),e("span",ot,s(r.value.order_type_label),1)])])]),default:h(()=>{var t,f,b,P;return[e("div",at,[e("div",rt,[e("div",nt,[lt,e("div",dt,[e("div",it,[ct,e("span",ut,s(r.value.created_date),1)])])]),e("div",_t,[mt,e("div",pt,[D(r.value)?(o(),a("div",ht,[xt,e("span",bt,s(r.value.product_name),1)])):ae(r.value)?(o(),a("div",vt,[yt,e("span",ft,s(r.value.item_name),1)])):m("",!0),r.value.component?(o(),a("div",gt,[e("div",wt,[kt,e("div",null,[e("div",$t,s((t=r.value.component)==null?void 0:t.total_amount_including_tax_text)+"円",1),e("div",Ct,[e("span",St,"本体: "+s((f=r.value.component)==null?void 0:f.total_amount_text)+"円",1),e("span",Vt,"税: "+s((b=r.value.component)==null?void 0:b.consumption_tax_text)+"円",1)])])])])):m("",!0)])])]),D(r.value)&&((P=r.value.components)!=null&&P.length)?(o(),a("div",Pt,[e("div",Tt,[e("h3",qt,[S("構成パーツ"),e("small",null,"（"+s(r.value.components.length)+"件）",1)])]),e("div",zt,[e("table",It,[e("tbody",null,[(o(!0),a(w,null,T(r.value.components,(i,M)=>{var F,K,R,E,j,G;return o(),a("tr",{key:i.id,class:O(["border-b border-main-100 last:border-0 hover:bg-main-50",{"bg-main-50":M%2===0,"bg-white":M%2===1}])},[e("td",Mt,s(M+1)+". "+s(i.key_name),1),e("td",Ut,[i.component_group_type==="main"||i.component_group_type==="sub"?(o(),a("div",Bt,s((K=(F=i.parameters.material)==null?void 0:F.data)==null?void 0:K.name)+"（"+s((E=(R=i.parameters.color)==null?void 0:R.data)==null?void 0:E.name)+"） ",1)):m("",!0),i.component_group_type==="common"?(o(),a("div",Ot,s((G=(j=i.parameters.color)==null?void 0:j.data)==null?void 0:G.name),1)):m("",!0),i.component_group_type==="logo"?(o(),a("div",At,[i.parameters.logo===!0?(o(),a("div",Lt," ロゴあり ")):i.parameters.logo===!1?(o(),a("div",Nt," ロゴなし ")):m("",!0)])):m("",!0)]),e("td",null,s(new Intl.NumberFormat().format(i.amount))+"円 ",1)],2)}),128))])])])])):m("",!0)])]}),_:1},8,["modelValue"])],64))}},Ft=e("h2",{class:"font-semibold text-indigo-50 leading-tight"},"注文管理",-1),Kt={class:"sm:py-6"},Rt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Et={class:"bg-white overflow-hidden shadow-sm"},jt={class:"p-5 sm:p-10"},es={__name:"Index",props:{guard:{type:String,required:!0},orderTypes:{type:Array,required:!0}},setup(u){return(k,v)=>(o(),a(w,null,[d(X(ce),{title:"注文管理"}),d(re,null,{header:h(()=>[Ft]),default:h(()=>[e("div",Kt,[e("div",Rt,[e("div",Et,[e("div",jt,[d(Dt,{guard:u.guard,"order-types":u.orderTypes},null,8,["guard","order-types"])])])])])]),_:1})],64))}};export{es as default};
